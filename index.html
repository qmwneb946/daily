<!DOCTYPE html>
<html>
<head>
<title>Codeforces 今日提交记录</title>
<style>
/* 新增自适应表格样式 */
table {
  table-layout: auto; /* 核心自适应设置[2]() */
  width: 100%;
  max-width: 100vw;
  overflow-x: auto; /* 响应式溢出滚动[5]() */
  box-shadow: 0 0 20px rgba(0,0,0,0.1);
}
th, td {
  white-space: nowrap; /* 防止内容换行 */
  min-width: 120px; /* 最小列宽 */
  max-width: 400px; /* 最大列宽 */
  overflow: hidden;
  text-overflow: ellipsis;
}
/* 原有样式保留 */
body { font-family: 'Segoe UI', sans-serif; margin:40px; background:#f4f4f9; }
th { background:#2196F3; color:white; padding:12px; }
tr:nth-child(even) { background:#f9f9f9; }
</style>
</head>
<body>
<h2>今日提交记录</h2>
<table id="dataTable">
  <thead></thead>
  <tbody></tbody>
</table>
 
<script>
function parseCSV(csv) {
  const rows = csv.split(/\r?\n/); 
  const headers = rows[0].split(',').map(h => h.trim()); 
  const data = [];
  
  for (let i=1; i<rows.length;  i++) {
    const cells = rows[i].match(/(".*?"|[^",]+)(?=,|$)/g) || [];
    const obj = {};
    headers.forEach((h,  idx) => {
      obj[h] = (cells[idx] || '').replace(/^"(.*)"$/, '$1').trim();
    });
    data.push(obj); 
  }
  return { headers, data };
}
 
function buildTable() {
  fetch('today.csv').then(r  => r.text()).then(csv  => {
    const { headers, data } = parseCSV(csv);
    const table = document.getElementById('dataTable'); 
    
    // 构建表头 
    const thead = table.createTHead(); 
    const headerRow = thead.insertRow(); 
    headers.forEach(h  => {
      const th = document.createElement('th'); 
      th.textContent  = h;
      headerRow.appendChild(th); 
    });
 
    // 填充数据 
    const tbody = table.createTBody(); 
    data.forEach(row  => {
      const tr = tbody.insertRow(); 
      headers.forEach(h  => {
        const td = tr.insertCell(); 
        if(h === 'problem') {
          td.innerHTML  = `<a href="https://codeforces.com/problemset/problem/${row.contest}/${row.index}"  
                            target="_blank">${row[h]}</a>`;
        } else {
          td.textContent  = row[h];
        }
      });
    });
  });
}
 
window.onload  = buildTable;
</script>
</body>
</html>
